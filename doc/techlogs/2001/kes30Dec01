              Technical notes on version 1.10 30Dec01
                       30 December 2001
                        Kern Sibbald

General:
- Integration of John's changes of 29 Dec to Bacula, which
  convert Bacula to c++ and add immortal.w and filesys.w
  to src/lib.
- Integration of my changes since John's base.
- Implemented a traceback feature triggered when 
  a daemon dies due to a signal.
- The Director needs a QueryFile in order to run
  the query command. It is defined in the configuration file.
- findlib/match.c now has code that handles the include/exclude
  file lists.


Changes submitted this submission:
- Enhanced configure.in to handle the GMP directory.
  New configure option:
    --with-gmp[=DIR]
  New substitution variables:
    GMP_INC
    GMP_LIBS
    GMP_LDFLAGS
    GMP_SRC
  New #define
    HAVE_GMP 
  The HAVE_GMP is probably redundant since we must
  always have gmp.  The other substitution variables
  need to be correctly defined. I just set them to
  something more or less arbitrary.
- Removed the old sendmail stuff from configure.in
- Added a new configure options
  --with-email=<email-address>
  currently only used in the new traceback feature,
  but will probably be added to the mail command.
- I got tired of Bacula dying with no traceback so added
  a traceback feature. I've long wondered how to do this,
  and it turns out to be rather simple, simply fork, then
  execv a script file that calls the debugger.  The 
  script is btraceback.  See <base>/src/lib/signal.c for
  more details.
- Fixed startit and stopit to work out of the source directory
  rather than bacula/k.
- Fixed a bug in the sqlquery command when no output was produced.
- Figured out how to do retension periods. 
- Modified Console to handle multiple Directors in its configuration
  file. If there is more than one, it will prompt you with a choice.
- Enhanced each daemon's status output to print a summary of the
  last job run.
- Made the Console query command read the queries and prompts from
  a file. This file is defined by the QueryFile configuration
  statement.
- Since CYGWIN doesn't have %T is strftime, changed it to %M:%S.
- Moved the Console run command into its own file.
- Added code to allow modification of all parameters in a job
  to be run. You will be prompted yes/mod/no. Entering mod prompts
  you for the parameters to modify. Most are implemented, but there
  is still some work to do.
- Moved makepath.c, save-cwd.c, and save-cwd.h from filed to lib.    
- Rewrote the include/exclude code in findlib. The old tar code in
  names.c is no longer used. The new file is called match.c
  The old tar code that walks through the directory tree is now
  confined to find_one.c. This will be replaced by John's code.
- Moved create_file.c to lib.
- Enhanced bextract and bls to handle include/exclude file lists.
- Started writing bscan.
